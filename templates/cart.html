<!DOCTYPE html>
<html lang="en">
<head>
Â Â Â Â <meta charset="UTF-8">
Â Â Â Â <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â Â Â Â <title>Your Cart</title>
Â Â Â Â <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
Â Â Â Â <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
Â Â Â Â <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
Â Â Â Â <style>
Â Â Â Â Â Â Â Â .cart-container {
Â Â Â Â Â Â Â Â Â Â Â Â display: flex;
Â Â Â Â Â Â Â Â Â Â Â Â gap: 20px;
Â Â Â Â Â Â Â Â Â Â Â Â margin: 20px;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â .cart-card {
Â Â Â Â Â Â Â Â Â Â Â Â border: 1px solid #ddd;
Â Â Â Â Â Â Â Â Â Â Â Â border-radius: 8px;
Â Â Â Â Â Â Â Â Â Â Â Â padding: 15px;
Â Â Â Â Â Â Â Â Â Â Â Â box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
Â Â Â Â Â Â Â Â Â Â Â Â display: flex;
Â Â Â Â Â Â Â Â Â Â Â Â flex-direction: column;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â .cart-items-card {
Â Â Â Â Â Â Â Â Â Â Â Â flex: 2;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â .summary-card {
Â Â Â Â Â Â Â Â Â Â Â Â flex: 1;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â .cart-item {
Â Â Â Â Â Â Â Â Â Â Â Â display: flex;
Â Â Â Â Â Â Â Â Â Â Â Â align-items: center;
Â Â Â Â Â Â Â Â Â Â Â Â justify-content: space-between;
Â Â Â Â Â Â Â Â Â Â Â Â margin-bottom: 15px;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â .cart-item img {
Â Â Â Â Â Â Â Â Â Â Â Â max-width: 100px;
Â Â Â Â Â Â Â Â Â Â Â Â height: auto;
Â Â Â Â Â Â Â Â Â Â Â Â margin-right: 15px;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â .cart-item-details {
Â Â Â Â Â Â Â Â Â Â Â Â flex: 1;
Â Â Â Â Â Â Â Â Â Â Â Â display: flex;
Â Â Â Â Â Â Â Â Â Â Â Â flex-direction: column;
Â Â Â Â Â Â Â Â Â Â Â Â justify-content: center;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â .cart-item-details p {
Â Â Â Â Â Â Â Â Â Â Â Â margin: 0;
Â Â Â Â Â Â Â Â Â Â Â Â font-size: 16px;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â .cart-item-price {
Â Â Â Â Â Â Â Â Â Â Â Â min-width: 100px;
Â Â Â Â Â Â Â Â Â Â Â Â text-align: right;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â .totals {
Â Â Â Â Â Â Â Â Â Â Â Â display: flex;
Â Â Â Â Â Â Â Â Â Â Â Â flex-direction: column;
Â Â Â Â Â Â Â Â Â Â Â Â justify-content: space-between;
Â Â Â Â Â Â Â Â Â Â Â Â gap: 20px;
Â Â Â Â Â Â Â Â Â Â Â Â margin-top: 20px;
Â Â Â Â Â Â Â Â Â Â Â Â padding-top: 40px;
Â Â Â Â Â Â Â Â Â Â Â Â border-top: 1px solid #ddd;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â .totals p {
Â Â Â Â Â Â Â Â Â Â Â Â margin: 0;
Â Â Â Â Â Â Â Â Â Â Â Â font-size: 18px;
Â Â Â Â Â Â Â Â Â Â Â Â font-weight: bold;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â .coupon-section form {
Â Â Â Â Â Â Â Â Â Â Â Â display: flex;
Â Â Â Â Â Â Â Â Â Â Â Â gap: 10px;
Â Â Â Â Â Â Â Â Â Â Â Â align-items: center;
Â Â Â Â Â Â Â Â Â Â Â Â margin-bottom: 20px;
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â .coupon-section input {
Â Â Â Â Â Â Â Â Â Â Â Â flex: 1;
Â Â Â Â Â Â Â Â Â Â Â Â padding: 10px;
Â Â Â Â Â Â Â Â Â Â Â Â border: 1px solid #ddd;
Â Â Â Â Â Â Â Â Â Â Â Â border-radius: 5px;
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â .coupon-section button {
Â Â Â Â Â Â Â Â Â Â Â Â padding: 10px 15px;
Â Â Â Â Â Â Â Â Â Â Â Â background-color: #4caf50;
Â Â Â Â Â Â Â Â Â Â Â Â color: white;
Â Â Â Â Â Â Â Â Â Â Â Â border: none;
Â Â Â Â Â Â Â Â Â Â Â Â border-radius: 5px;
Â Â Â Â Â Â Â Â Â Â Â Â cursor: pointer;
Â Â Â Â Â Â Â Â Â Â Â Â font-size: 14px;
Â Â Â Â Â Â Â Â Â Â Â Â font-weight: bold;
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â .coupon-section button:hover {
Â Â Â Â Â Â Â Â Â Â Â Â background-color: #45a049;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â .buttons {
Â Â Â Â Â Â Â Â Â Â Â Â display: flex;
Â Â Â Â Â Â Â Â Â Â Â Â justify-content: space-between;
Â Â Â Â Â Â Â Â Â Â Â Â margin-top: auto;
Â Â Â Â Â Â Â Â Â Â Â Â gap: 10px;
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â .buttons a {
Â Â Â Â Â Â Â Â Â Â Â Â flex: 1;
Â Â Â Â Â Â Â Â Â Â Â Â margin: 0;
Â Â Â Â Â Â Â Â Â Â Â Â padding: 7px 7px;
Â Â Â Â Â Â Â Â Â Â Â Â background-color: #4caf50;
Â Â Â Â Â Â Â Â Â Â Â Â color: white;
Â Â Â Â Â Â Â Â Â Â Â Â text-decoration: none;
Â Â Â Â Â Â Â Â Â Â Â Â border-radius: 5px;
Â Â Â Â Â Â Â Â Â Â Â Â text-align: center;
Â Â Â Â Â Â Â Â Â Â Â Â white-space: normal;
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â .buttons a:hover {
Â Â Â Â Â Â Â Â Â Â Â Â background-color: #45a049;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â .flash-message {
Â Â Â Â Â Â Â Â Â Â Â Â padding: 10px;
Â Â Â Â Â Â Â Â Â Â Â Â margin: 20px 0;
Â Â Â Â Â Â Â Â Â Â Â Â border-radius: 5px;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â .flash-message.success {
Â Â Â Â Â Â Â Â Â Â Â Â background-color: #d4edda;
Â Â Â Â Â Â Â Â Â Â Â Â color: #155724;
Â Â Â Â Â Â Â Â Â Â Â Â border: 1px solid #c3e6cb;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â .flash-message.error {
Â Â Â Â Â Â Â Â Â Â Â Â background-color: #f8d7da;
Â Â Â Â Â Â Â Â Â Â Â Â color: #721c24;
Â Â Â Â Â Â Â Â Â Â Â Â border: 1px solid #f5c6cb;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â .navbar {
Â Â Â Â Â Â Â Â Â Â Â Â background-color: #4a5b2a;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â .navbar .nav-link {
Â Â Â Â Â Â Â Â Â Â Â Â color: #ffffff !important;
Â Â Â Â Â Â Â Â }
Â Â Â Â </style>
</head>
<body>

Â Â Â Â <nav class="navbar navbar-expand-sm sticky-top rounded m-3" style="background-color: #4a5b2a;">
Â Â Â Â Â Â Â Â <div class="container-xxl d-flex align-items-center">
Â Â Â Â Â Â Â Â Â Â Â Â <div class="logo-container d-flex align-items-center">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <a href="{{ url_for('home') }}">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <img src="{{ url_for('static', filename='corn.png') }}" alt="Cornucopia Logo" 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â style="width: 65px; height: 65px; margin-right: 10px;">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </a>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="navbar-text text-light" style="font-size: 24px; font-weight: bold; margin-right: 20px;">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Cornucopia
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </span>
Â Â Â Â Â Â Â Â Â Â Â Â </div>
Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â <div class="navbar-nav">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <a class="nav-link text-light" href="{{ url_for('home') }}">Home</a>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <a class="nav-link text-light" href="{{ url_for('cart') }}">Cart</a>
Â Â Â Â Â Â Â Â Â Â Â Â </div>
Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â <form class="d-flex ms-auto search-container" role="search">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <input class="form-control me-2" type="search" placeholder="Search" id="search-input">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <button class="btn btn-dark" type="submit">Search</button>
Â Â Â Â Â Â Â Â Â Â Â Â </form>
Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â <a href="{{ url_for('profile') }}" class="ms-3 text-light">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <i class="fas fa-user"></i> Welcome, {{ username }}
Â Â Â Â Â Â Â Â Â Â Â Â </a>
Â Â Â Â Â Â Â Â Â Â Â Â <a href="{{ url_for('cart') }}" class="ms-3 text-light">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <i class="fas fa-shopping-cart"></i> ðŸ›’ (<span id="cart-counter">{{ session.get('cart_total', 0) }}</span>)
Â Â Â Â Â Â Â Â Â Â Â Â </a>
Â Â Â Â Â Â Â Â </div>
Â Â Â Â </nav>

Â Â Â Â {% with messages = get_flashed_messages(with_categories=true) %}
Â Â Â Â Â Â Â Â {% if messages %}
Â Â Â Â Â Â Â Â <div>
Â Â Â Â Â Â Â Â Â Â Â Â {% for category, message in messages %}
Â Â Â Â Â Â Â Â Â Â Â Â <div class="flash-message {{ category }}">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â {{ message }}
Â Â Â Â Â Â Â Â Â Â Â Â </div>
Â Â Â Â Â Â Â Â Â Â Â Â {% endfor %}
Â Â Â Â Â Â Â Â </div>
Â Â Â Â Â Â Â Â {% endif %}
Â Â Â Â {% endwith %}

Â Â Â Â <h1>My Cart</h1>

Â Â Â Â {% if cart %}
Â Â Â Â <div class="cart-container">
Â Â Â Â Â Â Â Â <div class="cart-card cart-items-card">
Â Â Â Â Â Â Â Â Â Â Â Â <h2>Items in Your Cart</h2>
Â Â Â Â Â Â Â Â Â Â Â Â <ul style="list-style-type: none; padding: 0;">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â {% for item in cart %}
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <li class="cart-item">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <img class="product-image" src="{{ item.image }}" alt="{{ item.name }}" 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â onerror="this.onerror=null; this.src='{{ url_for('static', filename='images/default.jpg') }}';">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <div class="cart-item-details">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <p>{{ item.name }}</p>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <div style="display: flex; align-items: center; gap: 10px;">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <label for="quantity-{{ item.id }}" style="margin-right: 10px;">Quantity:</label>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <input 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â type="number" 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â id="quantity-{{ item.id }}" 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â class="quantity-input" 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â name="quantity" 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â value="{{ item.quantity }}" 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â min="1" 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â data-product-id="{{ item.id }}"
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â style="width: 60px; padding: 5px; border: 1px solid #ddd; border-radius: 5px; text-align: center;">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <button 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â class="delete-button" 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â data-product-id="{{ item.id }}"
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â style="padding: 5px 10px; background-color: red; color: white; border: none; border-radius: 5px; cursor: pointer;">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Delete
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </button>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </div>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </div>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <div class="cart-item-price">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <p>${{ "%.2f" | format(item.price * item.quantity) }}</p>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </div>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </li>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â {% endfor %}
Â Â Â Â Â Â Â Â Â Â Â Â </ul>
Â Â Â Â Â Â Â Â </div>
Â Â Â Â 
Â Â Â Â Â Â Â Â <div class="cart-card summary-card">
Â Â Â Â Â Â Â Â Â Â Â Â <h2>Order Summary</h2>
Â Â Â Â Â Â Â Â Â Â Â Â <div class="totals">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <p>Subtotal: <span id="subtotal">${{ "%.2f" | format(subtotal) }}</span></p>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <p>Tax (8.63%): <span id="tax">${{ "%.2f" | format(tax) }}</span></p>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <p>Total: <span id="total">${{ "%.2f" | format(total) }}</span></p>
Â Â Â Â Â Â Â Â Â Â Â Â </div>

Â Â Â Â Â Â Â Â Â Â Â Â <div class="coupon-section" style="margin-top: 20px;">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <form method="post" style="display: flex; gap: 10px; align-items: center;">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <label for="coupon" style="font-size: 16px; font-weight: bold;">Coupon Code:</label>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <input 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â type="text" 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â id="coupon" 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â name="coupon" 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â placeholder="Enter your coupon" 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 10px;">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <button type="submit" style="padding: 10px; background-color: #4caf50; color: white; border: none; border-radius: 10px; cursor: pointer;">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Apply
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </button>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <button type="button" style="padding: 10px; background-color: red; color: white; border: none; border-radius: 10px; cursor: pointer;">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Remove
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </button>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â </form>
Â Â Â Â Â Â Â Â Â Â Â Â </div>

Â Â Â Â Â Â Â Â Â Â Â Â <div class="buttons">
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <a href="{{ url_for('home') }}">Continue Shopping</a>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <a href="{{ url_for('clear_cart') }}">Clear Cart</a>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <a href="{{ url_for('checkout') }}">Proceed to Checkout</a>
Â Â Â Â Â Â Â Â Â Â Â Â </div>
Â Â Â Â Â Â Â Â </div>
Â Â Â Â </div>
Â Â Â Â {% else %}
Â Â Â Â Â Â Â Â <p>Your cart is empty.</p>
Â Â Â Â Â Â Â Â <a href="{{ url_for('home') }}">Back to Home</a>
Â Â Â Â {% endif %}


Â Â Â Â <script>
Â Â Â Â Â Â Â Â document.addEventListener('DOMContentLoaded', () => {
Â Â Â Â Â Â Â Â Â Â Â Â document.querySelectorAll('.quantity-input').forEach(input => {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â input.addEventListener('change', async (event) => {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const productId = event.target.getAttribute('data-product-id');
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const newQuantity = event.target.value;
Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â try {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const response = await fetch(`/update_quantity/${productId}`, {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â method: 'POST',
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â headers: { 'Content-Type': 'application/json' },
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â body: JSON.stringify({ quantity: newQuantity }),
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â });
Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if (response.ok) {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const data = await response.json();
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â updateCart(data, event.target.closest('.cart-item'), productId);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } else {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â alert('Error updating quantity.');
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } catch (error) {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â console.error('Fetch error:', error);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â });
Â Â Â Â Â Â Â Â Â Â Â Â });
Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â document.querySelectorAll('.delete-button').forEach(button => {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â button.addEventListener('click', async (event) => {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const productId = event.target.getAttribute('data-product-id');
Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â try {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const response = await fetch(`/delete_item/${productId}`, {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â method: 'POST',
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â });
Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if (response.ok) {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const data = await response.json();
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const cartItem = event.target.closest('.cart-item');
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if (cartItem) cartItem.remove();
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â updateCart(data);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } else {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â alert('Error deleting item.');
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } catch (error) {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â console.error('Fetch error:', error);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â });
Â Â Â Â Â Â Â Â Â Â Â Â });
Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â function updateCart(data, cartItem = null, productId = null) {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â document.querySelector('#subtotal').textContent = `$${data.subtotal.toFixed(2)}`;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â document.querySelector('#tax').textContent = `$${data.tax.toFixed(2)}`;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â document.querySelector('#total').textContent = `$${data.total.toFixed(2)}`;
Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if (cartItem && productId && data.itemPrices) {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â const itemPriceElement = cartItem.querySelector('.cart-item-price p');
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â itemPriceElement.textContent = `$${data.itemPrices[productId].toFixed(2)}`;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â });
Â Â Â Â </script>
</body>
</html>